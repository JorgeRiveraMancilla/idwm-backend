databases:
  - name: tienda-ucn-database
    databaseName: tienda_ucn
    user: tienda_ucn_user
    plan: free

services:
  # Web Service
  - type: web
    name: tienda-ucn-api
    plan: free
    runtime: docker
    healthCheckPath: /api/health
    envVars:
      # Database - Render proporciona DATABASE_URL automáticamente, pero el código espera DATABASE_CONNECTION_STRING
      - key: DATABASE_CONNECTION_STRING
        fromDatabase:
          name: tienda-ucn-database
          property: connectionString

      # JWT
      - key: JWT_SECRET
        sync: false # Debe configurarse manualmente en Render dashboard

      # Resend
      - key: RESEND_API_KEY
        sync: false

      # Cloudinary
      - key: CLOUDINARY__CLOUD_NAME
        sync: false
      - key: CLOUDINARY__API_KEY
        sync: false
      - key: CLOUDINARY__API_SECRET
        sync: false

      # CORS - Formato de array con índices para .NET Configuration
      - key: CORS__ALLOWED_ORIGINS__0
        value: https://your-frontend-domain.com
      - key: CORS__ALLOWED_METHODS__0
        value: GET
      - key: CORS__ALLOWED_METHODS__1
        value: POST
      - key: CORS__ALLOWED_METHODS__2
        value: PUT
      - key: CORS__ALLOWED_METHODS__3
        value: DELETE
      - key: CORS__ALLOWED_METHODS__4
        value: PATCH
      - key: CORS__ALLOWED_METHODS__5
        value: OPTIONS
      - key: CORS__ALLOWED_HEADERS__0
        value: "*"

      # Serilog (opcional, tienen valores por defecto)
      - key: SERILOG__MINIMUM_LEVEL
        value: Information
      - key: SERILOG__OUTPUT_TEMPLATE
        value: "[{Timestamp:HH:mm:ss} {Level:u3}] {Message:lj}{NewLine}{Exception}"

      # Identity
      - key: IDENTITY_CONFIGURATION__ALLOWED_USER_NAME_CHARACTERS
        value: "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._@+"

      # Hangfire
      - key: HANGFIRE_DASHBOARD__DASHBOARD_PATH
        value: /hangfire
      - key: HANGFIRE_DASHBOARD__DASHBOARD_TITLE
        value: "Panel de Control de Hangfire"
      - key: HANGFIRE_DASHBOARD__STATS_POLLING_INTERVAL
        value: 5000
      - key: HANGFIRE_DASHBOARD__DISPLAY_STORAGE_CONNECTION_STRING
        value: false

      # Jobs
      - key: JOBS__CRON_JOB_DELETE_UNCONFIRMED_USERS
        value: "50 20 * * *"
      - key: JOBS__TIME_ZONE
        value: "Pacific SA Standard Time"
      - key: JOBS__DAYS_OF_DELETE_UNCONFIRMED_USERS
        value: 7

      # Verification Code
      - key: VERIFICATION_CODE__EXPIRATION_TIME_IN_MINUTES
        value: 3

      # Email
      - key: EMAIL_CONFIGURATION__WELCOME_SUBJECT
        sync: false
      - key: EMAIL_CONFIGURATION__FROM
        sync: false
      - key: EMAIL_CONFIGURATION__VERIFICATION_SUBJECT
        sync: false

      # Products
      - key: PRODUCTS__FEW_UNITS_AVAILABLE
        value: 15
      - key: PRODUCTS__DEFAULT_IMAGE_URL
        value: "https://shop.songprinting.com/global/images/PublicShop/ProductSearch/prodgr_default_300.png"
      - key: PRODUCTS__DEFAULT_PAGE_SIZE
        value: 10
      - key: PRODUCTS__IMAGE_ALLOWED_EXTENSIONS__0
        value: .jpg
      - key: PRODUCTS__IMAGE_ALLOWED_EXTENSIONS__1
        value: .jpeg
      - key: PRODUCTS__IMAGE_ALLOWED_EXTENSIONS__2
        value: .png
      - key: PRODUCTS__IMAGE_ALLOWED_EXTENSIONS__3
        value: .webp
      - key: PRODUCTS__IMAGE_MAX_SIZE_IN_BYTES
        value: 5242880
      - key: PRODUCTS__TRANSFORMATION_WIDTH
        value: 1000
      - key: PRODUCTS__TRANSFORMATION_CROP
        value: scale
      - key: PRODUCTS__TRANSFORMATION_QUALITY
        value: auto:best
      - key: PRODUCTS__TRANSFORMATION_FETCH_FORMAT
        value: auto

      # Cookie
      - key: COOKIE_EXPIRATION_DAYS
        value: 30

      # User Admin (configurar manualmente por seguridad)
      - key: USER__ADMIN_USER__EMAIL
        sync: false
      - key: USER__ADMIN_USER__PASSWORD
        sync: false
      - key: USER__ADMIN_USER__FIRST_NAME
        sync: false
      - key: USER__ADMIN_USER__LAST_NAME
        sync: false
      - key: USER__ADMIN_USER__RUT
        sync: false
      - key: USER__ADMIN_USER__BIRTH_DATE
        sync: false
      - key: USER__ADMIN_USER__PHONE_NUMBER
        sync: false
      - key: USER__RANDOM_USER_PASSWORD
        sync: false
